# Quanvolutional Neural Network (QNN)

In this project we implement a *Quanvolutional Neural Network*, a quantum machine learning model originally introduced in [Henderson et al. (2019)](https://arxiv.org/abs/1904.04767).

## Introduction

A *Convolutional Neural Network* (**CNN**) is a standard model in (classical) machine learning, especially suitable for image processing. This model is based on the idea of a *convolution layer* where, instead of processing the full input data with a global function, a *local* convolution is applied.
Small local regions are sequentially processed with the same kernel. The results obtained for each region are then associated to different channels of a single output pixel. The union of all the output pixels produces a new image-like object, which can be further processed by additional layers.

One can then consider **quantum variational circuits**, which are quantum algorithms depending on free parameters. These algorithms are trained by a **classical optimization** algorithm that makes queries to the **quantum device**, the optimization being an iterative scheme that searches out better candidates for the parameters with every step. Variational circuits have become popular as a way to think about quantum algorithms for **near-term quantum devices**.

In this notebook we will implement a simplified approach, which will, however, allow us to grasp the idea behind the so-called Quanvolutional Neural Networks (**QNNs**). The scheme is represented in the figure.

![Circuit](https://raw.githubusercontent.com/viventriglia/Quantum_Neural_Network_QNN/main/figures/circuit.png)

1.  A small region of the input image, in our example a $2 \times 2$ square, is embedded into a quantum circuit – this is achieved with parametrized rotations applied to the qubits initialized in the ground state.
2.  A quantum computation, associated to a unitary $U$, is performed on the system – the unitary could be generated by a variational quantum circuit or, more simply, by a *random circuit* as proposed in [Henderson et al. (2019)](https://arxiv.org/abs/1904.04767).
3.  The quantum system is measured, obtaining a list of classical expectation values.
4.  Analogously to a classical convolution layer, each expectation value is mapped to a different channel of a single output pixel.
5.  Iterating the same procedure over different regions, one can scan the full input image, producing an output object which will be structured as a multi-channel image.

**Note** that:
- a fixed non-trainable quantum circuit is used as a "quanvolution" kernel, while the subsequent classical layers are trained for the classification problem of interest;
- the quanvolution can be followed by further quantum layers or by classical layers;
- the **main difference** with respect to a classical convolution is that a quantum circuit can generate highly-complex kernels whose computation could be – at least in principle – classically intractable.
